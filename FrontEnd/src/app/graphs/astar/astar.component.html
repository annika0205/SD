<div class="container">
    <h1>A* Algorithmus Visualisierung</h1>
    
    <div class="mode-selector">
      <button (click)="setMode('grid')" [class.active]="mode === 'grid'">Grid-Ansicht</button>
      <button (click)="setMode('graph')" [class.active]="mode === 'graph'">Graph-Ansicht</button>
    </div>
    
    <div class="controls">
      <button (click)="startAlgorithm()" [disabled]="isRunning">Start</button>
      <button (click)="resetVisualization()">Zurücksetzen</button>
      <button (click)="randomizeObstacles()" *ngIf="mode === 'grid'">Zufällige Hindernisse</button>
      <button (click)="toggleDiagonals()" *ngIf="mode === 'grid'">Diagonalen {{ allowDiagonals ? 'deaktivieren' : 'aktivieren' }}</button>
      <button (click)="addNode()" *ngIf="mode === 'graph'">Knoten hinzufügen</button>
      <button (click)="toggleEdgeCreation()" *ngIf="mode === 'graph'">{{ creatingEdge ? 'Kantenauswahl beenden' : 'Kante hinzufügen' }}</button>
    </div>
    
    <div class="visualization-container">
      <div *ngIf="mode === 'grid'" class="grid-container">
        <div class="grid" #gridContainer>
          <div *ngFor="let row of grid; let i = index" class="row">
            <div *ngFor="let cell of row; let j = index" 
                 [class]="getCellClass(cell)"
                 (click)="onCellClick(i, j)"
                 (mouseover)="onCellHover(i, j, $event)">
            </div>
          </div>
        </div>
        
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color start"></div>
            <span>Start</span>
          </div>
          <div class="legend-item">
            <div class="legend-color end"></div>
            <span>Ziel</span>
          </div>
          <div class="legend-item">
            <div class="legend-color wall"></div>
            <span>Hindernis</span>
          </div>
          <div class="legend-item">
            <div class="legend-color open"></div>
            <span>Offene Liste</span>
          </div>
          <div class="legend-item">
            <div class="legend-color closed"></div>
            <span>Geschlossene Liste</span>
          </div>
          <div class="legend-item">
            <div class="legend-color path"></div>
            <span>Pfad</span>
          </div>
        </div>
      </div>
      
      <div *ngIf="mode === 'graph'" class="graph-container">
        <canvas #graphCanvas></canvas>
        
        <div class="graph-instructions" *ngIf="!isRunning">
          <p>Klicken Sie auf die Fläche, um Knoten hinzuzufügen.</p>
          <p>Wählen Sie "Kante hinzufügen" und klicken Sie auf zwei Knoten, um eine Kante zu erstellen.</p>
          <p>Rechtsklick auf einen Knoten, um ihn als Start oder Ziel festzulegen.</p>
        </div>
      </div>
    </div>
    
    <div class="algorithm-info">
      <h3>Algorithmus-Informationen</h3>
      <p>
        Der A* Algorithmus ist ein informierter Suchalgorithmus, der den kürzesten Weg zwischen zwei Punkten findet.
        Er kombiniert die Vorteile des Dijkstra-Algorithmus (garantiert kürzesten Weg) und der Greedy Best-First-Search (verwendet Heuristik).
      </p>
      <p>
        <strong>Formel:</strong> f(n) = g(n) + h(n)
      </p>
      <p>
        <strong>g(n):</strong> Tatsächliche Kosten vom Start zum aktuellen Knoten<br>
        <strong>h(n):</strong> Heuristik (geschätzte Kosten vom aktuellen Knoten zum Ziel)<br>
        <strong>f(n):</strong> Gesamtkosten
      </p>
    </div>
  </div>